## 流媒体协议

> 流媒体是指采用流式传输的方式在 Internet 播放的媒体格式
> 流媒体又叫流式媒体，它是指商家用一个视频传送服务器把节目当成数据包发出来，传送到网络上
> 用户通过解压设备对这些数据进行解压之后，然后播放出来
> 流媒体以流的方式在网络中传输音频和视频、音频和多媒体文件
> 流媒体文件格式支持采用流式传输及播放的媒体格式
> 流式传输是将视频和音频等多媒体文件通过特殊的压缩方式分成一个个压缩包，由服务器向用户计算机连续、实时传输
> 在采用流式传输方式的系统中，用户不必像非流式播放那样等到整个文件全部下载完毕后才能看到当中的内容，而是只需要经过几秒钟或几十秒的启动延时即可在用户计算机上利用相应的播放器对压缩的视频或音频等流式媒体文件进行播放，剩余的部分将继续进行下载，直至播放完毕

### RTP（Real-time Transport Protocal）实时传输协议

用于Internet上针对多媒体数据流的一种传输层协议，RTP协议和RTP控制协议RTCP一起使用
它建立在UPD协议之上
以固定的数据率在网络上发送数据，客户端以同样的速度观看视频文件，当饮食画面播放过后就不可以重复播放，除非重定向向服务器要求数据

RTP协议详细说明了在互联网上传递音频和视频的标准数据包格式。RTP协议常用于流媒体系统（配合RTCP协议），视频会议和一键通（Push to Talk）系统（配合H.323或SIP），使它成为IP电话产业的技术基础。

RTP 本身并没有提供按时发送机制或其它服务质量（QoS）保证，它依赖于低层服务去实现这一过程。 RTP 并不保证传送或防止无序传送，也不确定底层网络的可靠性。 RTP 实行有序传送， RTP 中的序列号允许接收方重组发送方的包序列，同时序列号也能用于决定适当的包位置，例如：在视频解码中，就不需要顺序解码。


### RTCP（Real-time Transport Control 或 RTP Control Protocol）实时传输控制协议

实时传输控制协议是实时传输协议RTP的姐妹协议
他们RTP与RTCP一起使用，建立在UDP协议之上

RTCP为RTP媒体流提供信道外（out-of-band）控制。RTCP本身并不传输数据，但和RTP一起协作将多媒体数据打包和发送。RTCP定期在流多媒体会话参加者之间传输控制数据。RTCP的主要功能是为RTP所提供的服务质量（Quality of Service）提供反馈
RTCP收集相关媒体连接的统计信息，例如：传输字节数，传输分组数，丢失分组数，jitter，单向和双向网络延迟等等。网络应用程序可以利用RTCP所提供的信息试图提高服务质量，比如限制信息流量或改用压缩比较小的编解码器。RTCP本身不提供数据加密或身份认证。SRTCP可以用于此类用途。

RTP 传送具有实时属性的数据
RTCP 监控服务质量并传送正在进行的会话参与者的相关信息

### RTSP（Real Time Streaming Protocal） 实时流媒体会话协议

SDP 会话描述协议，RTP 实时传输协议，是用来控制声音或影像的多媒体串流协议，RTSP提供了一个可扩展的框架

- 是流媒体协议
- 公有协议，并有专门的机构做维护
- 一般传输ts，mp4格式的流
- RTSP一般需要 2-3 个通道，命令和数据通道分离


### WebRTC（Web Real-Time Communications）  网页及时通信

是一个支持网页浏览器进行实时语音对话或视频对话的API。它于2011年6月1日开源并在Google、Mozilla、Opera支持下被纳入万维网联盟的W3C推荐标准。

允许网络应用或者站点，在不借助中间媒介的情况下，建立浏览器之间点对点（Peer-to-Peer）的连接，实现视频流和（或）音频流或者其他任意数据的传输。WebRTC包含的这些标准使用户在无需安装任何插件或者第三方的软件的情况下，创建点对点（Peer-to-Peer）的数据分享和电话会议成为可能


### RTMP （Real Time Message Protocol）

- 是流媒体协议
- 是Adobe的私有协议，为完全公开
- 一般传输flv，f4v格式流
- RTMP一般在TCP 1个通道上传输命令和数据

### HLS （HTTP Live Streaming）

HTTP Live Streaming（HLS）是苹果公司(Apple Inc.)实现的基于HTTP的流媒体传输协议，可实现流媒体的直播和点播，主要应用在iOS系统，为iOS设备（如iPhone、iPad）提供音视频直播和点播方案。HLS点播，基本上就是常见的分段HTTP点播，不同在于，它的分段非常小

相对于常见的流媒体直播协议，例如RTMP协议、RTSP协议、MMS协议等，HLS直播最大的不同在于，直播客户端获取到的，并不是一个完整的数据流。HLS协议在服务器端将直播数据流存储为连续的、很短时长的媒体文件（MPEG-TS格式），而客户端则不断的下载并播放这些小文件，因为服务器端总是会将最新的直播数据生成新的小文件，这样客户端只要不停的按顺序播放从服务器获取到的文件，就实现了直播。由此可见，基本上可以认为，HLS是以点播的技术方式来实现直播。由于数据通过HTTP协议传输，所以完全不用考虑防火墙或者代理的问题，而且分段文件的时长很短，客户端可以很快的选择和切换码率，以适应不同带宽条件下的播放。不过HLS的这种技术特点，决定了它的延迟一般总是会高于普通的流媒体直播协议。

- 采集视频源和音频源的数据
- 对原始数据进行H264编码和AAC编码
- 视频和音频数据封装为MPEG-TS包
- HLS分段生成策略及m3u8索引文件
- HTTP传输协议

- ![image-20220415171510187](/Users/zhengkun/Library/Application Support/typora-user-images/image-20220415171510187.png)

